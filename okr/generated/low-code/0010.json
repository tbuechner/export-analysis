{
    "type": "cf.cplace.platform.ChangeListener",
    "code": "/*\n*Changelistener\n*Type:Progress\n*Description: whenever the gradingForecast of the progress is changed this changelistener updates the same in keyResult\n*Triggering attribute : \n*Author: Laxmi udapudi\n*/\n\ncplace.setLogName('set_gf_on_progress')\nconst KEY_RESULT = {\n  TYPE: 'cf.cplace.solution.okr.keyResult',\n  ATTR: {\n    TITLE: 'cf.cplace.solution.okr.title',\n    PROGRESS: 'cf.cplace.solution.okr.progress',\n    CONFIDENCELEVEL: 'cf.cplace.solution.okr.confidenceLevel',\n    GRADING_FORECAST: 'cf.cplace.solution.okr.gradingForecast'\n  }\n}\nconst PROGRESS = {\n  TYPE: 'cf.cplace.solution.okr.progress',\n  ATTR: {\n    KEY_RESULT: 'cf.cplace.solution.okr.keyResult',\n    CONFIDENCELEVEL: 'cf.cplace.solution.okr.confidenceLevel',\n    GRADING_FORECAST: 'cf.cplace.solution.okr.gradingForecast'\n  }\n}\n\nfunction main() {\n\n  let progress = changeEvent.getEntity();\n  let gradingForecast = progress.get(PROGRESS.ATTR.GRADING_FORECAST);\n  let keyResult = progress.get(PROGRESS.ATTR.KEY_RESULT);\n  let processGrading = keyResult.get(KEY_RESULT.ATTR.GRADING_FORECAST);\n\n  if (!isSet(progress) || !isSet(gradingForecast)) {\n    // Nothing to sync with\n    return;\n  }\n\n  if (gradingForecast === processGrading) {\n    return;\n  }\n\n  updatePage(keyResult, {\n    'cf.cplace.solution.okr.gradingForecast': gradingForecast\n  })\n}\n\nreturn main();\n\n// Check if a value is set\nfunction isSet(value) {\n  return !!value;\n}\n\n/*\n*Update the cplace page whenever there is change in attributes\n* @param {Page<T>} page\n* @param {(keyof CplaceTypes[T])[]} attributes\n*/\nfunction updatePage(page, customAttributes) {\n  let key = null;\n  for (key in customAttributes) {\n    if (customAttributes.hasOwnProperty(key)) {\n      page.registerAttributeForRefresh(key)\n    }\n  }\n  return cplace.actions().updatePage(page, {\n    customAttributes: customAttributes,\n  }\n    , {\n      setGeneratedName: true\n    }\n  );\n}",
    "attributes": [
        "cf.cplace.solution.okr.gradingForecast"
    ],
    "type_name": "cf.cplace.solution.okr.progress",
    "counter": 10
}